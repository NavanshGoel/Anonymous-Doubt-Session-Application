{"ast":null,"code":"'use strict';\n\nconst EventEmitter = require('events');\n\nconst JSONB = require('json-buffer');\n\nconst loadStore = opts => {\n  const adapters = {\n    redis: '@keyv/redis',\n    mongodb: '@keyv/mongo',\n    mongo: '@keyv/mongo',\n    sqlite: '@keyv/sqlite',\n    postgresql: '@keyv/postgres',\n    postgres: '@keyv/postgres',\n    mysql: '@keyv/mysql'\n  };\n\n  if (opts.adapter || opts.uri) {\n    const adapter = opts.adapter || /^[^:]*/.exec(opts.uri)[0];\n    return new (require(adapters[adapter]))(opts);\n  }\n\n  return new Map();\n};\n\nclass Keyv extends EventEmitter {\n  constructor(uri, opts) {\n    super();\n    this.opts = Object.assign({\n      namespace: 'keyv',\n      serialize: JSONB.stringify,\n      deserialize: JSONB.parse\n    }, typeof uri === 'string' ? {\n      uri\n    } : uri, opts);\n\n    if (!this.opts.store) {\n      const adapterOpts = Object.assign({}, this.opts);\n      this.opts.store = loadStore(adapterOpts);\n    }\n\n    if (typeof this.opts.store.on === 'function') {\n      this.opts.store.on('error', err => this.emit('error', err));\n    }\n\n    this.opts.store.namespace = this.opts.namespace;\n  }\n\n  _getKeyPrefix(key) {\n    return `${this.opts.namespace}:${key}`;\n  }\n\n  get(key) {\n    key = this._getKeyPrefix(key);\n    const store = this.opts.store;\n    return Promise.resolve().then(() => store.get(key)).then(data => {\n      data = typeof data === 'string' ? this.opts.deserialize(data) : data;\n\n      if (data === undefined) {\n        return undefined;\n      }\n\n      if (typeof data.expires === 'number' && Date.now() > data.expires) {\n        this.delete(key);\n        return undefined;\n      }\n\n      return data.value;\n    });\n  }\n\n  set(key, value, ttl) {\n    key = this._getKeyPrefix(key);\n\n    if (typeof ttl === 'undefined') {\n      ttl = this.opts.ttl;\n    }\n\n    if (ttl === 0) {\n      ttl = undefined;\n    }\n\n    const store = this.opts.store;\n    return Promise.resolve().then(() => {\n      const expires = typeof ttl === 'number' ? Date.now() + ttl : null;\n      value = {\n        value,\n        expires\n      };\n      return store.set(key, this.opts.serialize(value), ttl);\n    }).then(() => true);\n  }\n\n  delete(key) {\n    key = this._getKeyPrefix(key);\n    const store = this.opts.store;\n    return Promise.resolve().then(() => store.delete(key));\n  }\n\n  clear() {\n    const store = this.opts.store;\n    return Promise.resolve().then(() => store.clear());\n  }\n\n}\n\nmodule.exports = Keyv;","map":{"version":3,"sources":["/Users/kanavmittal/Downloads/Anonymous-Doubt-Session-Application-Ashank-App/node_modules/keyv/src/index.js"],"names":["EventEmitter","require","JSONB","loadStore","opts","adapters","redis","mongodb","mongo","sqlite","postgresql","postgres","mysql","adapter","uri","exec","Map","Keyv","constructor","Object","assign","namespace","serialize","stringify","deserialize","parse","store","adapterOpts","on","err","emit","_getKeyPrefix","key","get","Promise","resolve","then","data","undefined","expires","Date","now","delete","value","set","ttl","clear","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst EventEmitter = require('events');\nconst JSONB = require('json-buffer');\n\nconst loadStore = opts => {\n\tconst adapters = {\n\t\tredis: '@keyv/redis',\n\t\tmongodb: '@keyv/mongo',\n\t\tmongo: '@keyv/mongo',\n\t\tsqlite: '@keyv/sqlite',\n\t\tpostgresql: '@keyv/postgres',\n\t\tpostgres: '@keyv/postgres',\n\t\tmysql: '@keyv/mysql'\n\t};\n\tif (opts.adapter || opts.uri) {\n\t\tconst adapter = opts.adapter || /^[^:]*/.exec(opts.uri)[0];\n\t\treturn new (require(adapters[adapter]))(opts);\n\t}\n\treturn new Map();\n};\n\nclass Keyv extends EventEmitter {\n\tconstructor(uri, opts) {\n\t\tsuper();\n\t\tthis.opts = Object.assign(\n\t\t\t{\n\t\t\t\tnamespace: 'keyv',\n\t\t\t\tserialize: JSONB.stringify,\n\t\t\t\tdeserialize: JSONB.parse\n\t\t\t},\n\t\t\t(typeof uri === 'string') ? { uri } : uri,\n\t\t\topts\n\t\t);\n\n\t\tif (!this.opts.store) {\n\t\t\tconst adapterOpts = Object.assign({}, this.opts);\n\t\t\tthis.opts.store = loadStore(adapterOpts);\n\t\t}\n\n\t\tif (typeof this.opts.store.on === 'function') {\n\t\t\tthis.opts.store.on('error', err => this.emit('error', err));\n\t\t}\n\n\t\tthis.opts.store.namespace = this.opts.namespace;\n\t}\n\n\t_getKeyPrefix(key) {\n\t\treturn `${this.opts.namespace}:${key}`;\n\t}\n\n\tget(key) {\n\t\tkey = this._getKeyPrefix(key);\n\t\tconst store = this.opts.store;\n\t\treturn Promise.resolve()\n\t\t\t.then(() => store.get(key))\n\t\t\t.then(data => {\n\t\t\t\tdata = (typeof data === 'string') ? this.opts.deserialize(data) : data;\n\t\t\t\tif (data === undefined) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tif (typeof data.expires === 'number' && Date.now() > data.expires) {\n\t\t\t\t\tthis.delete(key);\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn data.value;\n\t\t\t});\n\t}\n\n\tset(key, value, ttl) {\n\t\tkey = this._getKeyPrefix(key);\n\t\tif (typeof ttl === 'undefined') {\n\t\t\tttl = this.opts.ttl;\n\t\t}\n\t\tif (ttl === 0) {\n\t\t\tttl = undefined;\n\t\t}\n\t\tconst store = this.opts.store;\n\n\t\treturn Promise.resolve()\n\t\t\t.then(() => {\n\t\t\t\tconst expires = (typeof ttl === 'number') ? (Date.now() + ttl) : null;\n\t\t\t\tvalue = { value, expires };\n\t\t\t\treturn store.set(key, this.opts.serialize(value), ttl);\n\t\t\t})\n\t\t\t.then(() => true);\n\t}\n\n\tdelete(key) {\n\t\tkey = this._getKeyPrefix(key);\n\t\tconst store = this.opts.store;\n\t\treturn Promise.resolve()\n\t\t\t.then(() => store.delete(key));\n\t}\n\n\tclear() {\n\t\tconst store = this.opts.store;\n\t\treturn Promise.resolve()\n\t\t\t.then(() => store.clear());\n\t}\n}\n\nmodule.exports = Keyv;\n"]},"metadata":{},"sourceType":"script"}